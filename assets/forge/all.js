/*! Copyright 2011 Trigger Corp. All rights reserved. */
(function(){var j={};var g={};j.config={modules:{}};j.config.uuid="UUID_HERE";g.listeners={};var c={};var f=[];var e=null;var i=false;var k=function(){if(f.length>0){if(!g.debug||window.catalystConnected){i=true;while(f.length>0){var l=f.shift();if(l[0]=="logging.log"){console.log(l[1].message)}g.priv.call.apply(g.priv,l)}i=false}else{e=setTimeout(k,500)}}};g.priv={call:function(s,r,q,m){if((!g.debug||window.catalystConnected||s==="internal.showDebugWarning")&&(f.length==0||i)){var l=j.tools.UUID();var o=true;if(s==="button.onClicked.addListener"||s==="message.toFocussed"){o=false}if(q||m){c[l]={success:q,error:m,onetime:o}}var n={callid:l,method:s,params:r};g.priv.send(n);if(window._forgeDebug){try{n.start=(new Date().getTime())/1000;window._forgeDebug.forge.APICall.apiRequest(n)}catch(p){}}}else{f.push(arguments);if(!e){e=setTimeout(k,500)}}},send:function(l){throw new Error("Forge error: missing bridge to privileged code")},receive:function(l){if(l.callid){if(typeof c[l.callid]===undefined){j.log("Nothing stored for call ID: "+l.callid)}var n=c[l.callid];var m=(typeof l.content==="undefined"?null:l.content);if(n&&n[l.status]){n[l.status](l.content)}if(n&&n.onetime){delete c[l.callid]}if(window._forgeDebug){try{l.end=(new Date().getTime())/1000;window._forgeDebug.forge.APICall.apiResponse(l)}catch(o){}}}else{if(l.event){if(g.listeners[l.event]){g.listeners[l.event].forEach(function(p){if(l.params){p(l.params)}else{p()}})}if(g.listeners["*"]){g.listeners["*"].forEach(function(p){if(l.params){p(l.event,l.params)}else{p(l.event)}})}if(window._forgeDebug){try{l.start=(new Date().getTime())/1000;window._forgeDebug.forge.APICall.apiEvent(l)}catch(o){}}}}}};g.addEventListener=function(l,m){if(g.listeners[l]){g.listeners[l].push(m)}else{g.listeners[l]=[m]}};g.generateQueryString=function(m){if(!m){return""}if(!(m instanceof Object)){return new String(m).toString()}var n=[];var l=function(s,r){if(s===null){return}else{if(s instanceof Array){var p=0;for(var o in s){var q=(r?r:"")+"["+p+"]";p+=1;if(!s.hasOwnProperty(o)){continue}l(s[o],q)}}else{if(s instanceof Object){for(var o in s){if(!s.hasOwnProperty(o)){continue}var q=o;if(r){q=r+"["+o+"]"}l(s[o],q)}}else{n.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}}}};l(m);return n.join("&").replace("%20","+")};g.generateMultipartString=function(m,o){if(typeof m==="string"){return""}var n="";for(var l in m){if(!m.hasOwnProperty(l)){continue}if(m[l]===null){continue}n+="--"+o+"\r\n";n+='Content-Disposition: form-data; name="'+l.replace('"','\\"')+'"\r\n\r\n';n+=m[l].toString()+"\r\n"}return n};g.generateURI=function(m,l){var n="";if(m.indexOf("?")!==-1){n+=m.split("?")[1]+"&";m=m.split("?")[0]}n+=this.generateQueryString(l)+"&";n=n.substring(0,n.length-1);return m+(n?"?"+n:"")};g.disabledModule=function(l,m){var n="The '"+m+"' module is disabled for this app, enable it in your app config and rebuild in order to use this function";j.logging.error(n);l&&l({message:n,type:"UNAVAILABLE",subtype:"DISABLED_MODULE"})};j.enableDebug=function(){g.debug=true;g.priv.call("internal.showDebugWarning",{},null,null);g.priv.call("internal.hideDebugWarning",{},null,null)};setTimeout(function(){if(window.forge&&window.forge.debug){alert("Warning!\n\n'forge.debug = true;' is no longer supported\n\nUse 'forge.enableDebug();' instead.")}},3000);j.barcode={scan:function(m,l){g.disabledModule(l,"barcode")}};j.button={setIcon:function(m,n,l){g.disabledModule(l,"button")},setURL:function(m,n,l){g.disabledModule(l,"button")},onClicked:{addListener:function(l){g.disabledModule(error,"button")}},setBadge:function(m,n,l){g.disabledModule(l,"button")},setBadgeBackgroundColor:function(m,n,l){g.disabledModule(l,"button")},setTitle:function(n,m,l){g.disabledModule(l,"button")}};j.contact={select:function(m,l){g.priv.call("contact.select",{},m,l)},selectById:function(n,m,l){g.priv.call("contact.selectById",{id:n},m,l)},selectAll:function(m,l){g.priv.call("contact.selectAll",{},m,l)}};j.display={orientation:{forcePortrait:function(m,l){g.disabledModule(l,"display")},forceLandscape:function(m,l){g.disabledModule(l,"display")},allowAny:function(m,l){g.disabledModule(l,"display")}}};j.document={reload:function(){return document.location.reload()},location:function(m,l){m(document.location)}};j.event={menuPressed:{addListener:function(m,l){g.addEventListener("menuPressed",m)}},messagePushed:{addListener:function(m,l){g.addEventListener("event.messagePushed",m)}},orientationChange:{addListener:function(m,l){g.addEventListener("event.orientationChange",m);if(nullObj&&g.currentOrientation!==nullObj){g.priv.receive({event:"event.orientationChange"})}}},connectionStateChange:{addListener:function(m,l){g.addEventListener("event.connectionStateChange",m);if(nullObj&&g.currentConnectionState!==nullObj){g.priv.receive({event:"event.connectionStateChange"})}}},appPaused:{addListener:function(m,l){g.addEventListener("event.appPaused",m)}},appResumed:{addListener:function(m,l){g.addEventListener("event.appResumed",m)}}};j.facebook={authorize:function(n,m,o,l){if(typeof n=="function"){l=m;o=n;n=[];m=undefined}else{if(typeof m==="function"){l=o;o=m;m=undefined}}g.disabledModule(l,"facebook")},hasAuthorized:function(m,n,l){if(typeof m=="function"){l=audience;n=m;m=[];audience=undefined}else{if(typeof audience==="function"){l=n;n=audience;audience=undefined}}g.disabledModule(l,"facebook")},logout:function(m,l){g.disabledModule(l,"facebook")},api:function(m,p,o,n,l){if(typeof p=="function"||arguments.length==1){l=o}else{if(typeof o=="function"||arguments.length==2){l=n}}g.disabledModule(l,"facebook")},ui:function(n,m,l){g.disabledModule(l,"facebook")}};j.file={getImage:function(m,n,l){g.disabledModule(l,"file")},getVideo:function(m,n,l){g.disabledModule(l,"file")},getLocal:function(m,n,l){g.disabledModule(l,"file")},base64:function(m,n,l){g.disabledModule(l,"file")},string:function(m,n,l){g.disabledModule(l,"file")},URL:function(m,n,o,l){g.disabledModule(l,"file")},isFile:function(m,n,l){g.disabledModule(l,"file")},cacheURL:function(m,n,l){g.disabledModule(l,"file")},remove:function(m,n,l){g.disabledModule(l,"file")},clearCache:function(m,l){g.disabledModule(l,"file")}};j.geolocation={getCurrentPosition:function(o,n,p){if(typeof(o)==="object"){var m=o,q=n,l=p}else{var q=o,l=n,m=p}g.disabledModule(l,"geolocation")}};j.internal={ping:function(m,n,l){g.priv.call("internal.ping",{data:[m]},n,l)},call:g.priv.call,addEventListener:g.addEventListener};j.is={mobile:function(){return false},desktop:function(){return false},android:function(){return false},ios:function(){return false},chrome:function(){return false},firefox:function(){return false},safari:function(){return false},ie:function(){return false},web:function(){return false},orientation:{portrait:function(){return false},landscape:function(){return false}},connection:{connected:function(){return true},wifi:function(){return true}}};var d=function(r,p,s){var n=[];stylize=function(u,t){return u};function l(t){return t instanceof RegExp||(typeof t==="object"&&Object.prototype.toString.call(t)==="[object RegExp]")}function m(t){return t instanceof Array||Array.isArray(t)||(t&&t!==Object.prototype&&m(t.__proto__))}function o(v){if(v instanceof Date){return true}if(typeof v!=="object"){return false}var t=Date.prototype&&Object.getOwnPropertyNames(Date.prototype);var u=v.__proto__&&Object.getOwnPropertyNames(v.__proto__);return JSON.stringify(u)===JSON.stringify(t)}function q(F,C){try{if(F&&typeof F.inspect==="function"&&!(F.constructor&&F.constructor.prototype===F)){return F.inspect(C)}switch(typeof F){case"undefined":return stylize("undefined","undefined");case"string":var t="'"+JSON.stringify(F).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return stylize(t,"string");case"number":return stylize(""+F,"number");case"boolean":return stylize(""+F,"boolean")}if(F===null){return stylize("null","null")}if(F instanceof Document){return(new XMLSerializer()).serializeToString(F)}var z=Object.keys(F);var G=p?Object.getOwnPropertyNames(F):z;if(typeof F==="function"&&G.length===0){var u=F.name?": "+F.name:"";return stylize("[Function"+u+"]","special")}if(l(F)&&G.length===0){return stylize(""+F,"regexp")}if(o(F)&&G.length===0){return stylize(F.toUTCString(),"date")}var v,D,A;if(m(F)){D="Array";A=["[","]"]}else{D="Object";A=["{","}"]}if(typeof F==="function"){var y=F.name?": "+F.name:"";v=" [Function"+y+"]"}else{v=""}if(l(F)){v=" "+F}if(o(F)){v=" "+F.toUTCString()}if(G.length===0){return A[0]+v+A[1]}if(C<0){if(l(F)){return stylize(""+F,"regexp")}else{return stylize("[Object]","special")}}n.push(F);var x=G.map(function(I){var H,J;if(F.__lookupGetter__){if(F.__lookupGetter__(I)){if(F.__lookupSetter__(I)){J=stylize("[Getter/Setter]","special")}else{J=stylize("[Getter]","special")}}else{if(F.__lookupSetter__(I)){J=stylize("[Setter]","special")}}}if(z.indexOf(I)<0){H="["+I+"]"}if(!J){if(n.indexOf(F[I])<0){if(C===null){J=q(F[I])}else{J=q(F[I],C-1)}if(J.indexOf("\n")>-1){if(m(F)){J=J.split("\n").map(function(K){return"  "+K}).join("\n").substr(2)}else{J="\n"+J.split("\n").map(function(K){return"   "+K}).join("\n")}}}else{J=stylize("[Circular]","special")}}if(typeof H==="undefined"){if(D==="Array"&&I.match(/^\d+$/)){return J}H=JSON.stringify(""+I);if(H.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){H=H.substr(1,H.length-2);H=stylize(H,"name")}else{H=H.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");H=stylize(H,"string")}}return H+": "+J});n.pop();var E=0;var w=x.reduce(function(H,I){E++;if(I.indexOf("\n")>=0){E++}return H+I.length+1},0);if(w>50){x=A[0]+(v===""?"":v+"\n ")+" "+x.join(",\n  ")+" "+A[1]}else{x=A[0]+v+" "+x.join(", ")+" "+A[1]}return x}catch(B){return"[No string representation]"}}return q(r,(typeof s==="undefined"?2:s))};var h=function(m,n){if("logging" in j.config){var l=j.config.logging.marker||"FORGE"}else{var l="FORGE"}m="["+l+"] "+(m.indexOf("\n")===-1?"":"\n")+m;g.priv.call("logging.log",{message:m,level:n});if(typeof console!=="undefined"){switch(n){case 10:if(console.debug!==undefined&&!(console.debug.toString&&console.debug.toString().match("alert"))){console.debug(m)}break;case 30:if(console.warn!==undefined&&!(console.warn.toString&&console.warn.toString().match("alert"))){console.warn(m)}break;case 40:case 50:if(console.error!==undefined&&!(console.error.toString&&console.error.toString().match("alert"))){console.error(m)}break;default:case 20:if(console.info!==undefined&&!(console.info.toString&&console.info.toString().match("alert"))){console.info(m)}break}}};var a=function(l,m){if(l in j.logging.LEVELS){return j.logging.LEVELS[l]}else{j.logging.__logMessage("Unknown configured logging level: "+l);return m}};var b=function(m){var p=function(q){if(q.message){return q.message}else{if(q.description){return q.description}else{return""+q}}};if(m){var o="\nError: "+p(m);try{if(m.lineNumber){o+=" on line number "+m.lineNumber}if(m.fileName){var l=m.fileName;o+=" in file "+l.substr(l.lastIndexOf("/")+1)}}catch(n){}if(m.stack){o+="\r\nStack trace:\r\n"+m.stack}return o}return""};j.logging={LEVELS:{ALL:0,DEBUG:10,INFO:20,WARNING:30,ERROR:40,CRITICAL:50},debug:function(m,l){j.logging.log(m,l,j.logging.LEVELS.DEBUG)},info:function(m,l){j.logging.log(m,l,j.logging.LEVELS.INFO)},warning:function(m,l){j.logging.log(m,l,j.logging.LEVELS.WARNING)},error:function(m,l){j.logging.log(m,l,j.logging.LEVELS.ERROR)},critical:function(m,l){j.logging.log(m,l,j.logging.LEVELS.CRITICAL)},log:function(m,l,p){if(typeof(p)==="undefined"){var p=j.logging.LEVELS.INFO}try{var n=a(j.config.logging.level,j.logging.LEVELS.ALL)}catch(o){var n=j.logging.LEVELS.ALL}if(p>=n){h(d(m,false,10)+b(l),p)}}};j.media={videoPlay:function(m,n,l){g.disabledModule(l,"media")}};j.message={listen:function(m,n,l){g.disabledModule(l,"message")},broadcast:function(m,n,o,l){g.disabledModule(l,"message")},broadcastBackground:function(m,n,o,l){g.disabledModule(l,"message")},toFocussed:function(m,n,o,l){g.disabledModule(l,"message")}};j.notification={create:function(o,n,m,l){g.priv.call("notification.create",{title:o,text:n},m,l)}};j.payments={purchaseProduct:function(m,n,l){g.disabledModule(l,"payments")},restoreTransactions:function(m,l){g.disabledModule(l,"payments")},transactionReceived:{addListener:function(m,l){g.disabledModule(l,"payments")}}};j.prefs={get:function(m,n,l){g.priv.call("prefs.get",{key:m.toString()},n&&function(o){if(o==="undefined"){o=undefined}else{try{o=JSON.parse(o)}catch(p){l({message:p.toString()});return}}n(o)},l)},set:function(m,n,o,l){if(n===undefined){n="undefined"}else{n=JSON.stringify(n)}g.priv.call("prefs.set",{key:m.toString(),value:n},o,l)},keys:function(m,l){g.priv.call("prefs.keys",{},m,l)},all:function(m,l){var m=m&&function(n){for(key in n){if(n[key]==="undefined"){n[key]=undefined}else{n[key]=JSON.parse(n[key])}}m(n)};g.priv.call("prefs.all",{},m,l)},clear:function(m,n,l){g.priv.call("prefs.clear",{key:m.toString()},n,l)},clearAll:function(m,l){g.priv.call("prefs.clearAll",{},m,l)}};j.reload={updateAvailable:function(m,l){g.priv.call("reload.updateAvailable",{},m,l)},update:function(m,l){g.priv.call("reload.update",{},m,l)},applyNow:function(m,l){j.logging.error("reload.applyNow has been disabled, please see docs.trigger.io for more information.");l({message:"reload.applyNow has been disabled, please see docs.trigger.io for more information.",type:"UNAVAILABLE"})},switchStream:function(m,n,l){g.priv.call("reload.switchStream",{streamid:m},n,l)},updateReady:{addListener:function(m,l){g.addEventListener("reload.updateReady",m)}}};j.request={get:function(m,n,l){g.disabledModule(l,"request")},ajax:function(l){g.disabledModule(l.error,"request")}};j.sms={send:function(n,m,l){g.disabledModule(l,"sms")}};j.tabbar={show:function(m,l){g.disabledModule(l,"tabbar")},hide:function(m,l){g.disabledModule(l,"tabbar")},addButton:function(n,m,l){g.disabledModule(l,"tabbar")},removeButtons:function(m,l){g.disabledModule(l,"tabbar")},setTint:function(l,n,m){g.disabledModule(m,"tabbar")},setActiveTint:function(l,n,m){g.disabledModule(m,"tabbar")},setInactive:function(m,l){g.disabledModule(l,"tabbar")}};j.tabs={open:function(m,n,o,l){if(typeof n==="function"){l=o;o=n;n=false}g.disabledModule(l,"tabs")},openWithOptions:function(m,n,l){g.disabledModule(l,"tabs")},closeCurrent:function(l){g.disabledModule(l,"tabs")}};j.tools={UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var m=Math.random()*16|0;var l=n=="x"?m:(m&3|8);return l.toString(16)}).toUpperCase()},getURL:function(m,n,l){g.priv.call("tools.getURL",{name:m.toString()},n,l)}};j.topbar={show:function(m,l){g.disabledModule(l,"topbar")},hide:function(m,l){g.disabledModule(l,"topbar")},setTitle:function(n,m,l){g.disabledModule(l,"topbar")},setTitleImage:function(m,n,l){g.disabledModule(l,"topbar")},setTint:function(l,n,m){g.disabledModule(m,"topbar")},addButton:function(m,n,l){g.disabledModule(l,"topbar")},removeButtons:function(m,l){g.disabledModule(l,"topbar")},homePressed:{addListener:function(m,l){g.disabledModule(l,"topbar")}}};j.urlhandler={urlLoaded:{addListener:function(m,l){g.disabledModule(l,"urlhandler")}}};g.priv.send=function(m){if(window.__forge["callJavaFromJavaScript"]===undefined){return}var l=((m.params!==undefined)?JSON.stringify(m.params):"");window.__forge["callJavaFromJavaScript"](m.callid,m.method,l)};g.priv.get=function(){var l=JSON.parse(window.__forge["getObjects"]());l.forEach(function(m){g.priv.receive(m)})};g.priv.get();window.addEventListener("load",function(){g.priv.call("internal.hideLaunchImage",{},function(){},function(){})},false);j._get=g.priv.get;window.forge=j;window.forge["reload"]={updateAvailable:j.reload.updateAvailable,update:j.reload.update,applyNow:j.reload.applyNow,switchStream:j.reload.switchStream,updateReady:{addListener:j.reload.updateReady.addListener}};window.forge["ajax"]=j.request.ajax;window.forge["getPage"]=j.request.get;window.forge["createNotification"]=j.notification.create;window.forge["UUID"]=j.tools.UUID;window.forge["getURL"]=j.tools.getURL;window.forge["log"]=j.logging.log;window.forge["button"]["setUrl"]=j.button.setURL;window.forge["button"]["setBadgeText"]=j.button.setBadge;window.forge["file"]["delete"]=j.file.remove;window.forge["file"]["imageURL"]=j.file.URL})();